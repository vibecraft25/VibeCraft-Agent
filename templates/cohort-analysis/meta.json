{
  "type": "cohort-analysis",
  "name": "Cohort Analysis",
  "description": "코호트 기반 사용자 행동 분석 및 리텐션 시각화",
  "requiredLibraries": ["recharts", "@nivo/heatmap", "react-table"],
  "systemPrompt": "Create a cohort analysis visualization for tracking user retention, behavior patterns, and lifecycle metrics across different user cohorts.",
  "componentStructure": {
    "mainComponents": [
      {
        "name": "CohortMatrix",
        "description": "Cohort retention matrix/heatmap",
        "props": [
          { "name": "cohortData", "type": "CohortData[]" },
          { "name": "metric", "type": "MetricType" },
          { "name": "onCellClick", "type": "(cohort: string, period: number) => void" }
        ],
        "features": ["heatmap", "interactive-cells", "tooltips", "export"]
      },
      {
        "name": "RetentionCurve",
        "description": "Retention curves by cohort",
        "props": [
          { "name": "cohorts", "type": "Cohort[]" },
          { "name": "selectedCohorts", "type": "string[]" },
          { "name": "timeUnit", "type": "TimeUnit" }
        ],
        "features": ["multi-line", "comparison", "benchmarks"]
      },
      {
        "name": "CohortSelector",
        "description": "Cohort selection and filtering",
        "props": [
          { "name": "availableCohorts", "type": "Cohort[]" },
          { "name": "onSelectionChange", "type": "(cohorts: string[]) => void" },
          { "name": "groupBy", "type": "GroupingType" }
        ],
        "features": ["multi-select", "date-range", "custom-cohorts"]
      }
    ],
    "supportingComponents": [
      {
        "name": "CohortDetails",
        "description": "Detailed view of a specific cohort",
        "props": [
          { "name": "cohort", "type": "Cohort" },
          { "name": "metrics", "type": "CohortMetrics" }
        ],
        "features": ["user-list", "behavior-patterns", "segments"]
      },
      {
        "name": "MetricComparison",
        "description": "Compare metrics across cohorts",
        "props": [
          { "name": "cohorts", "type": "Cohort[]" },
          { "name": "metrics", "type": "string[]" }
        ],
        "features": ["bar-charts", "trends", "statistical-tests"]
      }
    ],
    "hooks": [
      {
        "name": "useCohortData",
        "description": "Hook for fetching and processing cohort data"
      },
      {
        "name": "useRetentionCalculation",
        "description": "Hook for calculating retention metrics"
      }
    ],
    "utils": [
      {
        "name": "cohortUtils",
        "description": "Cohort grouping and calculation utilities"
      },
      {
        "name": "retentionUtils",
        "description": "Retention calculation helpers"
      }
    ]
  },
  "dataProcessingPatterns": [
    {
      "name": "Basic Cohort Query",
      "sqlTemplate": "SELECT {{cohortColumn}}, {{periodColumn}}, COUNT(DISTINCT {{userIdColumn}}) as users FROM {{table}} GROUP BY {{cohortColumn}}, {{periodColumn}}",
      "dataTransformation": "buildCohortMatrix(results)"
    },
    {
      "name": "Retention Query",
      "sqlTemplate": "WITH cohorts AS (SELECT {{userIdColumn}}, MIN({{dateColumn}}) as cohort_date FROM {{table}} GROUP BY {{userIdColumn}}) SELECT cohort_date, {{periodDiff}} as period, COUNT(DISTINCT {{userIdColumn}}) as retained_users FROM {{table}} JOIN cohorts USING({{userIdColumn}}) GROUP BY cohort_date, period",
      "dataTransformation": "calculateRetentionRates(results)"
    },
    {
      "name": "Behavior Pattern Query",
      "sqlTemplate": "SELECT {{cohortColumn}}, {{actionColumn}}, COUNT(*) as actions, COUNT(DISTINCT {{userIdColumn}}) as users FROM {{table}} GROUP BY {{cohortColumn}}, {{actionColumn}}",
      "dataTransformation": "analyzeBehaviorPatterns(results)"
    }
  ]
}